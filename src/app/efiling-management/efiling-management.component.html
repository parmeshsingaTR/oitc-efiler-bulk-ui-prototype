<div class="efiling-management-container">
  <nav class="menu">
    <ul>
      <li><a routerLink="/dashboard">Dashboard</a></li>
      <li><a routerLink="/efiling-management">E-Filing Management</a></li>
      <li><a routerLink="/reports">Reports</a></li>
      <li>
        <a routerLink="/returns">Returns</a>
        <ul class="submenu">
          <li><a routerLink="/returns/summary">Summary</a></li>
          <li><a routerLink="/returns/details">Details</a></li>
          <li><a routerLink="/returns/history">History</a></li>
          <li><a routerLink="/returns/e-file-updates">E-file Updates</a></li>
        </ul>
      </li>
      <li><a routerLink="/settings">Settings</a></li>
    </ul>
  </nav>

  <div class="content-wrapper">
    <div class="selection-info" *ngIf="selection.selected.length > 0">
      {{ selection.selected.length }} records selected
    </div>

    <div class="grid-container">
      <table class="data-table">
        <thead>
          <tr>
            <th class="checkbox-column">
              <mat-checkbox (change)="masterToggle()" [checked]="isAllSelected()"></mat-checkbox>
            </th>
            <th class="actions-column">Actions</th>
            <th>Dataset</th>
            <th>Jurisdiction</th>
            <th>Entity Name</th>
            <th>Return Name</th>
            <th>Purpose</th>
            <th>Status</th>
            <th>Efile Status</th>
            <th>No Auto Rollforward</th>
            <th>Start Date</th>
            <th>End Date</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let row of rowData">
            <td class="checkbox-column">
              <mat-checkbox 
                (change)="$event ? selection.toggle(row) : null"
                [checked]="selection.isSelected(row)">
              </mat-checkbox>
            </td>
            <td class="actions-column">
              <button mat-icon-button [matMenuTriggerFor]="rowMenu" (click)="selectedRow = row">
                <mat-icon>more_vert</mat-icon>
              </button>
            </td>
            <td>{{ row.dataset }}</td>
            <td>{{ row.jurisdiction }}</td>
            <td>{{ row.entityName }}</td>
            <td>{{ row.returnName }}</td>
            <td>{{ row.purpose }}</td>
            <td>{{ row.status }}</td>
            <td>{{ row.efileStatus || 'Not Sent' }}</td>
            <td>{{ row.noAutoRollforward }}</td>
            <td>{{ row.startDate }}</td>
            <td>{{ row.endDate }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <mat-menu #rowMenu="matMenu">
    <button mat-menu-item *ngFor="let item of actionMenuItems" (click)="onActionClick(item.action)">
      <mat-icon>{{item.icon}}</mat-icon>
      <span>{{item.label}}</span>
    </button>
  </mat-menu>
</div>
